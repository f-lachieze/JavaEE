package org.example.ProjetJavaEE.Ex.modele;

import jakarta.persistence.*;

@Entity
@Table(name = "EXPLOITE")
public class Exploite {

    // 1. Déclaration de la Clé Composée
    @EmbeddedId
    private ExploiteId id;

    // 2. Mappage vers Composante (Many-to-One)
    @MapsId("team") // Mappe ce champ à la partie 'team' de l'ExploiteId
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "team", referencedColumnName = "acronyme")
    private Composante composante;

    // 3. Mappage vers Batiment (Many-to-One)
    @MapsId("building") // Mappe ce champ à la partie 'building' de l'ExploiteId
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "building", referencedColumnName = "codeB")
    private Batiment batiment;

    // Constructeur par défaut (obligatoire pour JPA)
    public Exploite() {}

    // Constructeur pour l'insertion des données du script initial
    public Exploite(Composante composante, Batiment batiment) {
        // Initialiser l'objet Composite ID
        this.id = new ExploiteId(composante.getAcronyme(), batiment.getCodeB());

        // Assigner les références d'objets
        this.composante = composante;
        this.batiment = batiment;
    }

    // --- Getters et Setters ---

    public ExploiteId getId() {
        return id;
    }

    public void setId(ExploiteId id) {
        this.id = id;
    }

    public Composante getComposante() {
        return composante;
    }

    public void setComposante(Composante composante) {
        this.composante = composante;
    }

    public Batiment getBatiment() {
        return batiment;
    }

    public void setBatiment(Batiment batiment) {
        this.batiment = batiment;
    }
}